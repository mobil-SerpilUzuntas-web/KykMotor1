@model ProductDetayViewModel
@{
    ViewData["Title"] = "detayText";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>


    * {
        box-sizing: border-box;
    }

  /*  img {
        vertical-align: middle;
    }*/

    .column {
        background-color: aliceblue;
    }
    /* Position the image container (needed to position the left and right arrows) */
    .container {
    }

    /* Hide the images by default */
    .mySlides {
        display: none;
    }

    /* Add a pointer when hovering over the thumbnail images */
    .cursor {
        cursor: pointer;
    }

    /* Next & previous buttons */
    .prev,
    .next {
        cursor: pointer;
        position: absolute;
        top: 51%;
        padding: 12px;
        margin-top: -50px;
        color: white;
        font-weight: bold;
        font-size: 24px;
        border-radius: 0 3px 3px 0;
        user-select: none;
        -webkit-user-select: none;
    }

    /* Position the "next button" to the right */
    .next {
        right: 2rem;
        border-radius: 3px 0 0 3px;
        background-color: black
    }

    .prev {
        left: 2rem;
        border-radius: 3px 0 0 3px;
        background-color: black
    }
        /* On hover, add a black background color with a little bit see-through */
        .prev:hover,
        .next:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

    /* Number text (1/3 etc) */
    .numbertext {
        color: #f2f2f2;
        font-size: 12px;
        padding: 8px 12px;
        position: absolute;
        top: 0;
    }

    /* Container for image text */
    .caption-container {
        text-align: center;
        background-color: #222;
        padding: 2px 16px;
        color: white;
    }

    .row:after {
        content: "";
        display: table;
        clear: both;
    }

    /* Six columns side by side */
    .column {
        float: left;
        width: 16.66%;
    }

        .column img {
            border-radius: 0;
        }
    /* Add a transparency effect for thumnbail images */
    .demo {
        opacity: 0.6;
    }

        .active,
        .demo:hover {
            opacity: 1;
        }


        .containerr {
           display:flex;
           justify-content: center;
         /*   margin: 200px 0 0 0;*/
        }

       .images {
        display:none;
        max-width: 300px;
        margin: 25px;
       }

            .images img {
                max-width: 100%;
            }

        .loupe {
            display: none;
            position: absolute;
            width: 200px;
            height: 200px;
            border: 1px solid black;
            box-shadow: 5px 5px 12px black;
            background: rgba(0, 0, 0, 0.25);
            cursor: crosshair;
            overflow: hidden;
           
        }

       .loupe img {
        position: absolute;
     
        }

</style>

<div id="wrapper">
    <section id="content" style="padding-top:20rem;padding-bottom:3em">
        <!-- shop section start -->
        <section id="shop" class="container">
            <!-- row start -->
            <div class="row">
                <!-- main column start -->
                <div class="col-md-9">
                    <div class="row">
                        <!-- product page top info start -->
                        <div class="col-md-12 product">
                            <div class="row">
                                <div class="col-md-6">
                                  @foreach (var item in Model.Resims)
                                   {
                                   
                                            <div class="images">
                                             <img src="~/kykİmg/@item.Name" >
                                           </div>
                                       
                                   }
                            @*  bu büyük resmin yandaki oklara tıklanınca slider için*@
                                    <div class="loupe"></div>
                                    <a class="prev" onclick="plusSlides(-1)">❮</a>
                                          <a class="next" onclick="plusSlides(1)">❯</a>
                                    <div class="caption-container">
                                        <p id="caption"></p>
                                    </div>

                                    <div class="row">
                                        @for (int i = 0; i < Model.Resims.Count; i++)
                                        {
                                            <div class="column">
                                                <img class="demo cursor" src="~/kykİmg/@Model.Resims[i].Name"
                                                 style="width:100%"
                                                 onclick="currentSlide(@(i + 1))"
                                                 alt="image @i">
                                            </div>
                                        }

                                    </div>
                                </div>
                                <div class="col-md-5">

                                    <div class="padding15">
                                        <h2 class="product-title"><b>@Model.ProductName</b></h2>
                                        <p>
                                            <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i>
                                            3 Reviews
                                        </p>
                                        <p class="product-price">@Model.Price</p>
                                    </div>
                                    <div class="padding15">

                                        <form method="post" class="form-inline">
                                            <div class="form-group qty">
                                                <div class="input-group">
                                                    <span class="input-group-addon">Adet</span>
                                                    <input type="number" size="4" class="form-control" value="1" min="1" step="1">
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary"><i class="fa fa-cart-plus fa-fw"></i> Sepete Ekle</button>
                                        </form>

                                    </div>



                                </div>
                            </div>  
                         </div>
                        <div class="col-md-12 padding25">
                            <ul class="nav nav-tabs">
                                <li class="active"><a data-toggle="tab" href="#acıklama">Ürün Açıklaması</a></li>
                                <li><a data-toggle="tab" href="#spec">Ürünün Tüm Özellikleri</a></li>

                            </ul>
                            <div class="tab-content">

                                <!-- description tab start -->
                                <div id="acıklama" class="tab-pane fade in active">
                                    <p>@Model.Description</p>

                                </div>
                                <!-- description tab end -->
                                <!-- Specifications tab start -->
                                <div id="spec" class="tab-pane fade">
                                    <div class="table-responsive">
                                        <ul>
                                            <li>Kışlık Eldiven</li>
                                            <li>Dışı Taraf Deri</li>
                                            <li>Dokusu Yumuşak</li>
                                            <li>Esnek</li>
                                        </ul>

                                    </div>
                                </div>
                                <!-- Specifications tab end -->


                            </div>

                        </div>
                     </div>
               </div>
                <!-- sidebar start -->
                <div id="sidebar" class="col-md-3">

                    <!-- search widget start -->
                    <div class="widget">
                        <form class="form-inline">
                            <div class="input-group">
                                <input type="text" class="form-control input-lg" placeholder="Arama...">
                                <span class="input-group-btn">
                                    <button class="btn btn-default btn-lg" type="submit"><i class="fa fa-search"></i></button>
                                </span>
                            </div>
                        </form>
                    </div>
                    <!-- search widget end -->
                    <!-- categories widget start -->
                    <div class="widget">
                        <h4>CATEGORIES</h4>
                        <ul class="list-unstyled link-list">
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Furniture <span class="pull-right">(5)</span></a></li>
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Electronics <span class="pull-right">(2)</span></a></li>
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Books <span class="pull-right">(1)</span></a></li>
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Accessories <span class="pull-right">(19)</span></a></li>
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Computers <span class="pull-right">(2)</span></a></li>
                            <li><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i> <a href="#">Cameras <span class="pull-right">(7)</span></a></li>
                        </ul>
                    </div>
                    <!-- categories widget end -->
                    <!-- featured products widget start -->
                    @*  YAN KISIM *@
                    <div class="widget">
                        <h4>yan bar</h4>

                        <div class="products-list">

                            <div class="media">
                                <a class="media-left" href="#">

                                    <img alt="" class="img-responsive product-thumb" src="~/edura/images/products/product1_thumb.jpg">
                                </a>
                                <div class="media-body">
                                    <a href="#" class="product-title">Photo Camera</a>
                                    <p class="product-price">$153</p>
                                </div>
                            </div>

                            <div class="media">
                                <a class="media-left" href="#">
                                    <img alt="" class="img-responsive product-thumb" src="~/edura/images/products/product2_thumb.jpg">
                                </a>
                                <div class="media-body">
                                    <a href="#" class="product-title">Wood Chair</a>
                                    <p class="product-price">$99</p>
                                </div>
                            </div>

                            <div class="media">
                                <a class="media-left" href="#">
                                    <img alt="" class="img-responsive product-thumb" src="~/edura/images/products/product3_thumb.jpg">
                                </a>
                                <div class="media-body">
                                    <a href="#" class="product-title">Comfortable Sofa</a>
                                    <p class="product-price">$526</p>
                                </div>
                            </div>

                            <div class="media">
                                <a class="media-left" href="#">
                                    <img alt="" class="img-responsive product-thumb" src="~/edura/images/products/product4_thumb.jpg">
                                </a>
                                <div class="media-body">
                                    <a href="#" class="product-title">Hand Bag</a>
                                    <p class="product-price">$125</p>
                                </div>
                            </div>

                            <div class="media">
                                <a class="media-left" href="#">
                                    <img alt="" class="img-responsive product-thumb" src="~/edura/images/products/product1_thumb.jpg">
                                </a>
                                <div class="media-body">
                                    <a href="#" class="product-title">Photo Camera</a>
                                    <p class="product-price">$29</p>
                                </div>
                            </div>

                        </div>

                    </div>
                    <!-- featured products widget end -->

                </div>
                <!-- sidebar end -->
               
                     <div class="col-md-12">
                            <!-- carousel start-->
                            <div class="text-center">
                          <h3>RELATED <b>Bukısma O anki gelen SubikiKategoryİsmi çekilecek</b></h3>
                            </div>
                            <h1>Bu Detay Sayfasında gösterilecek Slider</h1>
                          <div id="products-carousel" class="owl-carousel">
                                <!-- carousel start -->
                                @await Component.InvokeAsync("CategorySlider", new { Id = Model.Id })
                                <!--carousel end-->
                           </div>        

                      </div>


            </div>
                <!-- main column end -->
        </section>
        <!-- shop section end -->
    </section>
    <!-- CONTENT END -->
</div>

<script src="~/jquery/jquery.js"></script>


<script>
 

    let slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    function currentSlide(n) {
        showSlides(slideIndex = n);
    }

    function showSlides(n) {
        plusSlides
        let i;
        let slides = document.getElementsByClassName("mySlides");
        let dots = document.getElementsByClassName("demo");
        let captionText = document.getElementById("caption");
        if (n > slides.length) { slideIndex = 1 }
        if (n < 1) { slideIndex = slides.length }
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(" active", "");
        }
        slides[slideIndex - 1].style.display = "block";
        dots[slideIndex - 1].className += " active";
        let fullPath = slides[slideIndex - 1].getElementsByTagName("img")[0].src;
        let fileName = fullPath.substring(fullPath.lastIndexOf('/') + 1);
        fileName = fileName.substring(0, fileName.lastIndexOf('.')); // Uzantıyı kaldır
        captionText.innerHTML = fileName;// Sadece dosya adını al
        //captionText.innerHTML = fileName;

        //  let fileName = fullPath.substring(fullPath.lastIndexOf('/') + 1); // Dosya adı ve uzantıyı al
        //fileName = fileName.substring(0, fileName.lastIndexOf('.')); // Uzantıyı kaldır
        //captionText.innerHTML = fileName;

        //captionText.innerHTML = dots[slideIndex-1].alt;
    }


    var $loupe = $(".loupe"),
        loupeWidth = $loupe.width(),
        loupeHeight = $loupe.height();
    //resmin üzerine gidince tetiklenecek foksiyon bu foksiyonun amacı
    /* 1: sayfa yüklendiginde bir event oluştur event parametre olarak "mouseenter" dinle ve hangi dom elementinin üzerinde işlem yapılacagı ".image" ve bir fonction çalıştır*/

    $(document).on("mouseenter", ".images", function (e) {

        var $currImage = $(this),
            $img = $('<img/>')
                .attr('src', $('img', this).attr("src"))
                .css(
                    {
                        'width': $currImage.width() * 2,
                        'height': $currImage.height() * 2
                    });
        console.log("Resim Src:", $img.attr("src"));
        console.log("Resim Genişlik:", $img.width());
        console.log("Resim Yükseklik:", $img.height());
        $loupe.html($img).fadeIn(100);/* $loupe.html parametre olarak $img veriyoruz ve 100 yani 0.1 milisaniye resmin üzerine gidilin ce görülecek*/

        /* Bu sayfa yüklendigin de hazır halde bekletiliyor taki mause hareket etmeye başlatınca bu foksiyon tetiklenecek*/
        $(document).on("mousemove", moveHandler);
        function moveHandler(e) {
            var imageOffset = $currImage.offset(),
                fx = imageOffset.left - loupeWidth / 2,
                fy = imageOffset.top - loupeHeight / 2,
                fh = imageOffset.top + $currImage.height() + loupeHeight / 2,
                fw = imageOffset.left + $currImage.width() + loupeWidth / 2;
            console.log("imageOffset", imageOffset);
            var loupeOffset = $loupe.offset();
            console.log("loupeOffset", loupeOffset);



            $loupe.css({
                'left': e.pageX - 100,

                'top': e.pageY - 100
            });

            var loupeOffset = $loupe.offset(),
                lx = loupeOffset.left,
                ly = loupeOffset.top,
                lw = lx + loupeWidth,
                lh = ly + loupeHeight,
                bigy = (ly - loupeHeight / 4 - fy) * 2,
                bigx = (lx - loupeWidth / 4 - fx) * 2;

            $img.css({ 'left': -bigx, 'top': -bigy });

            if (lx < fx || lh > fh || ly < fy || lw > fw) {
                $img.remove();
                $(document).off("mousemove", moveHandler);
                $loupe.fadeOut(100);
            }
        }
    });

</script>

<!-- BOOTSTRAP JS -->



